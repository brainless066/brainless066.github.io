---
layout: "post"
title: "TITLE"
date: 2025-01-10 11:11:11 +/-0900
categories: Test
tags: test  
---

## Google Form Responses

<p id="loading-text">Loading<span id="dots">.</span></p> <!-- Animated Loading Message -->

<table id="google-sheet-table">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
    </tr>
  </thead>
  <tbody>
    <!-- Data will be inserted here -->
  </tbody>
</table>

<!-- Embedded Google Form -->
<h2>Submit Your Response</h2>
<div class="form-container">
  <iframe 
    src="https://docs.google.com/forms/d/e/1FAIpQLSe0rQT2BzGW0gAgBDAxLqp75eFzggi3d5O5Fs3hi5sKZzLhdw/viewform?embedded=true" 
    width="100%" height="700" frameborder="0" marginheight="0" marginwidth="0">
    Loading...
  </iframe>
</div>

<script>
// Function to animate "Loading..." dots
let dotCount = 1;
const dotsElement = document.getElementById("dots");
const loadingText = document.getElementById("loading-text");

function animateDots() {
    dotCount = (dotCount % 3) + 1; // Cycle through 1, 2, 3 dots
    dotsElement.textContent = ".".repeat(dotCount);
}
const dotInterval = setInterval(animateDots, 500); // Change every 500ms

async function fetchGoogleSheet() {
    const url = "https://script.google.com/macros/s/AKfycbx8W5ai_VFcBPTUlFQvOqDlPvXRVfyrZTC11yGFEUx0cUfFYsFVf11gvlQtF0W2wli-3Q/exec";
    
    try {
        const response = await fetch(url);
        const data = await response.json();

        const tbody = document.querySelector("#google-sheet-table tbody");
        tbody.innerHTML = ""; // Clear previous data

        data.slice(1).forEach(row => {
        let tr = document.createElement("tr");

        let td1 = document.createElement("td");
        td1.textContent = row.Column1;  // âœ… Prevents script execution
        tr.appendChild(td1);

        let td2 = document.createElement("td");
        td2.textContent = row.Column2;
        tr.appendChild(td2);

        let td3 = document.createElement("td");
        td3.textContent = row.Column3;
        tr.appendChild(td3);

        tbody.appendChild(tr);
});


        // Hide loading text and stop animation
        loadingText.style.display = "none";
        clearInterval(dotInterval); 

    } catch (error) {
        console.error("Error fetching Google Sheet:", error);
        loadingText.textContent = "Failed to load data!";
        clearInterval(dotInterval);
    }
}

// Load data when the page is loaded
document.addEventListener("DOMContentLoaded", fetchGoogleSheet);
</script>

<!-- Custom Styling for Better Layout -->
<style>
  /* Center the form and make it responsive */
  .form-container {
    max-width: 800px;
    margin: 20px auto;
    padding: 10px;
    text-align: center;
  }

  /* Responsive Design for Mobile */
  @media (max-width: 768px) {
    iframe {
      height: 600px; /* Adjust height for mobile */
    }
  }
</style>
