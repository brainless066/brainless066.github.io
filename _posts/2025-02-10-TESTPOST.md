---
layout: "post"
title: "TITLE"
date: 2025-01-10 11:11:11 +/-0900
categories: Test
tags: test  
---

## Google Form Responses

<p id="loading-text">Loading<span id="dots">.</span></p> <!-- Animated Loading Message -->

<!-- Thread Container -->
<div id="thread-container">
  <!-- Posts will be inserted here -->
</div>

<!-- Embedded Google Form -->
<h2>Submit Your Response</h2>
<div class="form-container">
  <iframe 
    src="https://docs.google.com/forms/d/e/1FAIpQLSe0rQT2BzGW0gAgBDAxLqp75eFzggi3d5O5Fs3hi5sKZzLhdw/viewform?embedded=true" 
    width="100%" height="700" frameborder="0" marginheight="0" marginwidth="0">
    Loading...
  </iframe>
</div>

<script>
// Function to animate "Loading..." dots
let dotCount = 1;
const dotsElement = document.getElementById("dots");
const loadingText = document.getElementById("loading-text");

function animateDots() {
    dotCount = (dotCount % 3) + 1; // Cycle through 1, 2, 3 dots
    dotsElement.textContent = ".".repeat(dotCount);
}
const dotInterval = setInterval(animateDots, 500); // Change every 500ms

async function fetchGoogleSheet() {
    const url = "https://script.google.com/macros/s/AKfycbx8W5ai_VFcBPTUlFQvOqDlPvXRVfyrZTC11yGFEUx0cUfFYsFVf11gvlQtF0W2wli-3Q/exec";

    try {
        const response = await fetch(url);
        const data = await response.json();

        const threadContainer = document.getElementById("thread-container");
        threadContainer.innerHTML = ""; // Clear previous data

        // Reverse the array so latest post is on top
        data.slice(1).reverse().forEach(row => {
            let post = document.createElement("div");
            post.classList.add("post");

            let timestamp = document.createElement("p");
            timestamp.classList.add("timestamp");
            timestamp.textContent = convertToKST(row.Column1); // Convert time to KST

            let title = document.createElement("h3");
            title.textContent = row.Column2; // Post title

            let content = document.createElement("p");
            content.textContent = row.Column3; // Post content

            post.appendChild(timestamp);
            post.appendChild(title);
            post.appendChild(content);

            threadContainer.appendChild(post);
        });

        // Hide loading text and stop animation
        loadingText.style.display = "none";
        clearInterval(dotInterval); 

    } catch (error) {
        console.error("Error fetching Google Sheet:", error);
        loadingText.textContent = "Failed to load data!";
        clearInterval(dotInterval);
    }
}

// Function to convert UTC timestamp to KST (UTC+9)
function convertToKST(utcDateStr) {
    const utcDate = new Date(utcDateStr);
    utcDate.setHours(utcDate.getHours() + 9);
    return utcDate.toISOString().replace("T", " ").split(".")[0]; // Format: YYYY-MM-DD HH:mm:ss
}

// Load data when the page is loaded
document.addEventListener("DOMContentLoaded", fetchGoogleSheet);
</script>

<!-- Custom Styling for Thread Format -->
<style>
  /* Thread Container */
  #thread-container {
    max-width: 800px;
    margin: 20px auto;
    padding: 10px;
    display: flex;
    flex-direction: column;
  }

  /* Individual Post */
  .post {
    border: 1px solid #ccc;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 5px;
  }

  /* Timestamp - Reduce margin below */
  .timestamp {
    font-size: 12px;
    color: #777;
    margin-bottom: 15px; /* Remove bottom margin */
    padding-bottom: 0px; /* Remove extra spacing */
    line-height: 1.2; /* Adjust spacing */
  }

  /* Title - Remove extra spacing */
  h3 {
    margin-top: 2px !important; /* Reduce top margin */
    margin-bottom: 15px !important; /* Reduce bottom margin */
    padding-top: 0px !important;
    padding-bottom: 0px !important;
    line-height: 1.2; /* Make text closer together */
  }

  p {
    margin: 5px 0;
  }

  /* Responsive Design for Mobile */
  @media (max-width: 768px) {
    .post {
      padding: 10px;
    }
  }
</style>
